<!DOCTYPE html>
<html>
  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title> Cursors &amp; RecyclerViews, Smurf Yeah! | TnT</title>
<meta name="description" content="using-cursors-with-recycler-views">
<meta name="keywords" content="">
<link rel="stylesheet" href="/css/main.css">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="theme-color" content="#2ecc71">
<link rel="canonical" href="/using-cursors-with-recycler-views">
<link rel="alternate" type="application/rss+xml" title="TnT" href="/feed.xml" />
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
    <meta name="robots" content="noindex"> <!--=====  Please remove it ! ! !  ======-->
    <meta name="googlebot" content="noindex"> <!--=====  Please remove it ! ! !  ======-->
  </head>
  <body class="single">
    <main class="container">
        <header class="site-header">
  <div class="container txt-center">
    <nav class="navbar">
      <ul>
        <li><a href="/">home</a></li>
        <li class="divider">&bull;</li>
        <li><a href="/about">about</a></li>
        <li class="divider">&bull;</li>
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> feed</a></li>
      </ul>
    </nav>
  </div>
</header>
        <section class="main-content">
          <article class="post">
  <header class="post-header">
    <h1 class="post-title">Cursors & RecyclerViews, Smurf Yeah!</h1>
    <p class="post-meta">Apr 12, 2016</p>
  </header>
  <div class="post-content">
    <p>Every time I start a new Android project I know for a fact that there will be
some sort of content provider/resolver laden snake pit that I will inevitably fall
into. Most recently it was trying to get RecyclerViews to play nicely with Cursors.
Cursors, of course are what gets returned by a content resolver when it queries the SQLite
datastore that comes baked into Android <sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>.</p>
<<<<<<< HEAD
<p>The issue is one of multiple inheritance. a standard RecyclerView adapter definition looks like:</p>
<<<<<<< HEAD
<noscript><pre>## Test
This is a test gist.</pre></noscript>
<script src="https://gist.github.com/parkr/c08ee0f2726fd0e3909d.js?file=test.md"> </script>
<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p><small> I know what you’re going to say: “Don’t use SQLite! Use —-“, where —- is one of a </small> number of options. This post isn’t for you &lt;/small&gt; <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
=======
<noscript><pre>Not Found</pre></noscript>
<script src="https://gist.github.com/swolfand/e9814d654fc536641e6c64a4ff480941.js?file=CursorRecyclerViewAdapter.md"> </script>
=======
<p>The issue is multiple inheritance, and the fact that it conflicts with the <a href="http://developer.android.com/training/improving-layouts/smooth-scrolling.html#ViewHolder">ViewHolder</a> pattern.
 To see what this means take a look at what a standard RecyclerView adapter and CursorAdpter definitions looks like:</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MyAdapter</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">&lt;</span><span class="n">MyAdapter</span><span class="o">.</span><span class="na">MyViewHolder</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">MyAdapter</span><span class="o">()</span>
  <span class="c1">//inflation and binding of view holder happens here</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyViewHolder</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span> <span class="o">{</span>  
      <span class="c1">// define your view holder</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">// adapter</span></code></pre></div>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">CustomDataAdapter</span> <span class="kd">extends</span> <span class="n">CursorAdapter</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">CustomDataAdapter</span><span class="o">()</span>
  <span class="c1">//bind view and new view go here</span>
<span class="o">}</span> <span class="c1">// adapter</span></code></pre></div>
<p>As you can see, the ViewHolder pattern is enforced by default in any RecyclerView adapter via inheritance and
a CursorAdapter also uses extension of the CursorAdapter interface in order to conform to protocols.
This creates an issue when you want your RecyclerView to use your cursor data via it’s adapter.
Since Java doesn’t have multiple inheritance through extension we are forced to do a little
magic with generics.</p>
<p>If you’re like me, you’ve avoided generics like the plague, because lazy.
However, in this case generics provide the most elegant solution.  By creating
a base cursor recycler adapter we can abstract away a lot of the boilerplate and headache.</p>
<p>The overall idea is as follows, define a CursorRecyclerViewAdapter that extends from RecyclerView.Adapter that has a generic swappable ViewHolder as it’s elements.
you’ll also need a NotifyingDataSetObserver.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">CursorRecyclerViewAdapter</span><span class="o">&lt;</span><span class="n">VH</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">Adapter</span><span class="o">&lt;</span><span class="n">VH</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">CursorRecyclerViewAdapter</span><span class="o">(</span><span class="n">Cursor</span> <span class="n">cursor</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//this might change based on your use case</span>
    <span class="o">...</span>
  <span class="o">}</span>
  <span class="c1">//bind view and new view go here</span>
  <span class="kd">private</span> <span class="kd">class</span> <span class="nc">NotifyingDataSetObserver</span> <span class="kd">extends</span> <span class="n">DataSetObserver</span> <span class="o">{</span>
          <span class="nd">@Override</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onChanged</span><span class="o">()</span> <span class="o">{</span>
              <span class="o">...</span>
          <span class="o">}</span>
          <span class="nd">@Override</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onInvalidated</span><span class="o">()</span> <span class="o">{</span>
              <span class="o">...</span>
          <span class="o">}</span>
      <span class="o">}</span>
<span class="o">}</span></code></pre></div>
<p>Check out this <a href="https://gist.github.com/swolfand/e9814d654fc536641e6c64a4ff480941">gist</a> for the full CursorRecyclerViewAdapter code.</p>
<p>from there you’re free to extend this class to work with your RecyclerView Adapter from above</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MyAdapter</span> <span class="kd">extends</span> <span class="n">QuoteCursorAdapter</span><span class="o">&lt;</span><span class="n">QuoteCursorAdapter</span><span class="o">.</span><span class="na">MyViewHolder</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nf">MyAdapter</span><span class="o">()</span>
  <span class="c1">//inflation and binding of view holder happens here</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyViewHolder</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span> <span class="o">{</span>  
      <span class="c1">// define your view holder</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">// adapter</span></code></pre></div>
>>>>>>> bbb53cb98354a222acf8f6a74a1f44c80258561f
<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p><small> I know what you’re going to say: “Don’t use SQLite! Use —-“, where —- is one of a number of options. This post isn’t for you </small> <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
<<<<<<< HEAD
>>>>>>> 085fd2052ea088f15bfd5dc602a103ed413cad3f
=======
>>>>>>> bbb53cb98354a222acf8f6a74a1f44c80258561f
    </li>
  </ol>
</div>
    <aside class="share">
      <span>Share this: </span>
      <a href="http://twitter.com/share?text=Cursors & RecyclerViews, Smurf Yeah!&amp;url=/using-cursors-with-recycler-views&amp;hashtags=web,dev,blog,soudev&amp;via=nandomoreirame"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <i class="icon icon-twitter-rounded"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/using-cursors-with-recycler-views"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <i class="icon icon-facebook-rounded"></i>
      </a>
    </aside>
  </div>
  <hr>
  <aside id="comments" class="disqus">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = '';
      var disqus_identifier = '/using-cursors-with-recycler-views';
      var disqus_title = 'Cursors & RecyclerViews, Smurf Yeah!';
      var disqus_url = '';
      /*var disqus_developer = 1;*/
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>
      Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
    </noscript>
  </aside>
</article>
        </section>
<div class="clearfix"></div>
<footer class="site-footer txt-center">
  <hr>
  <ul class="social">
        <li><a href="" target="_blank"><i class="icon icon-"></i></a></li>
        <li><a href="http://github.com/swolfand" target="_blank"><i class="icon icon-github"></i></a></li>
        <li><a href="" target="_blank"><i class="icon icon-"></i></a></li>
        <li><a href="" target="_blank"><i class="icon icon-facebook"></i></a></li>
        <li><a href="" target="_blank"><i class="icon icon-"></i></a></li>
        <li><a href="http://twitter.com/swolfand" target="_blank"><i class="icon icon-twitter"></i></a></li>
        <li><a href="" target="_blank"><i class="icon icon-"></i></a></li>
        <li><a href="http://instagram.com/thewolf77" target="_blank"><i class="icon icon-instagram"></i></a></li>
        <li><a href="" target="_blank"><i class="icon icon-"></i></a></li>
        <li><a href="http://linkedin.com/in/samwolfand" target="_blank"><i class="icon icon-linkedin"></i></a></li>
  </ul>
  <small>&copy; 2016 All rights reserved. Made with <a href="http://jekyllrb.com" target="_blank">Jekyll</a> and <i class="icon icon-heart"></i></small>
  <small>by <a href="http://nandomoreira.me" target="_blank">nandomoreira.me</a></small>
</footer>
    </main>
    <a href="https://github.com/swolfand/swolfand.github.io" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#2ecc71; color:#f7f8f9; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
  </body>
</html>
